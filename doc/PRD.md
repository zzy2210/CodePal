# CodePal - 移动端 AI 开发助手 PRD

## 文档信息
- **版本**: v0.1.0 (草稿)
- **更新日期**: 2025-08-30
- **文档状态**: 初稿

---

## 1. 产品概述

### 1.1 产品定位
CodePal 是一款移动端 AI 开发助手应用，让开发者能够随时随地通过手机访问和使用 AI 编程工具。首期支持 Claude Code，因其 TUI（终端用户界面）特性更适合移动端交互。

### 1.2 核心价值
- **移动化开发**：突破地点限制，随时随地进行代码开发和调试
- **远程协作**：通过手机管理远程开发环境，提升工作灵活性
- **实时通知**：及时接收开发环境的重要提醒，避免错过关键操作

### 1.3 目标用户
- 需要远程办公的开发者
- 经常出差的技术人员
- 希望利用碎片时间编程的开发者

---

## 2. 核心功能

### 2.1 设备管理
- 支持添加和管理多台远程服务器
- 查看设备状态和配置信息
- 快速切换不同开发环境

### 2.2 工作目录管理
- 浏览远程服务器的文件系统
- 创建和管理工作目录
- 记录常用工作目录，支持快速访问

### 2.3 AI 交互
- 与 Claude Code 进行实时对话
- 支持代码编写、调试和优化
- 保存对话历史，支持上下文恢复

### 2.4 智能通知
- 操作超时提醒
- 任务完成通知
- 异常状态告警

---

## 3. 用户场景

### 场景一：远程开发

#### 用户故事
作为一名开发者，我希望能够通过手机连接到远程服务器进行开发，以便在外出时也能处理紧急的代码问题。

#### 操作流程
1. **登录应用**：用户打开 CodePal APP，使用账号登录
2. **选择设备**：从设备列表中选择目标服务器
3. **进入工作目录**：浏览并选择工作目录（参考 VSCode Remote SSH 体验）
4. **启动 Claude Code**：
   - APP 建立 SSH 连接到目标服务器
   - 自动启动 Claude Code 实例
   - 建立数据转发通道
5. **交互操作**：
   - 通过对话框与 Claude Code 交互
   - 使用悬浮按钮快速访问常用命令（如 `/mode` 切换计划执行模式）
   - 通过交互式选项完成操作

### 场景二：智能提醒

#### 用户故事
作为一名开发者，我希望在 Claude Code 需要我确认操作时及时收到通知，避免因未及时响应导致任务中断。

#### 操作流程
1. **配置监听**：在开发机器上启动伪终端（pseudo-terminal）
2. **运行 Claude Code**：在伪终端中执行 Claude Code
3. **触发通知**：
   - 当 Claude Code 需要用户选择或确认
   - 超过预设时间（默认 30 秒）未响应
   - APP 推送通知提醒用户
4. **快速响应**：用户通过通知快速进入 APP 完成操作

---

## 4. 产品架构

### 4.1 技术架构
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   移动端    │ ──> │   服务端    │ ──> │  远程服务器  │
│  (APP)      │     │  (中转层)   │     │ (Claude Code)│
└─────────────┘     └─────────────┘     └─────────────┘
```

### 4.2 关键技术
- **SSH 连接管理**：安全的远程连接和会话管理
- **WebSocket**：实时双向数据传输
- **推送通知**：及时的消息推送服务
- **终端模拟**：移动端终端交互体验优化

---

## 5. 交互设计

### 5.1 主要界面
1. **设备列表页**：展示所有已配置的服务器
2. **文件浏览器**：类似 IDE 的文件系统浏览
3. **对话界面**：与 Claude Code 的交互界面
4. **悬浮工具栏**：快捷命令和操作

### 5.2 交互优化
- 支持手势操作（滑动、长按等）
- 自适应键盘弹出
- 代码高亮显示
- 智能命令补全

---

## 6. 非功能需求

### 6.1 性能要求
- 连接延迟 < 500ms
- 消息响应时间 < 1s
- 支持断线重连

### 6.2 安全要求
- SSH 密钥加密存储
- 传输数据加密
- 支持多因素认证

### 6.3 兼容性
- iOS 14.0+ / Android 8.0+
- 支持横竖屏切换
- 适配不同屏幕尺寸

---

## 7. 开发计划

### Phase 1：MVP 版本（4 周）
- [ ] 基础设备管理
- [ ] SSH 连接功能
- [ ] Claude Code 基础交互
- [ ] 简单的对话界面

### Phase 2：功能完善（4 周）
- [ ] 文件浏览器
- [ ] 悬浮工具栏
- [ ] 推送通知
- [ ] 会话管理

### Phase 3：体验优化（2 周）
- [ ] 交互优化
- [ ] 性能优化
- [ ] UI 美化

---

## 8. 成功指标

- **用户活跃度**：DAU/MAU > 40%
- **会话时长**：平均会话时长 > 10 分钟
- **任务完成率**：> 80% 的远程操作成功完成
- **用户满意度**：应用商店评分 > 4.5

---

## 9. 风险与对策

| 风险 | 影响 | 对策 |
|------|------|------|
| 网络延迟高 | 影响用户体验 | 优化数据传输，增加缓存机制 |
| 安全漏洞 | 数据泄露风险 | 定期安全审计，及时更新补丁 |
| Claude Code API 变更 | 功能失效 | 建立版本兼容层，支持多版本 |

---

## 10. 附录

### 参考资料
- VSCode Remote SSH 文档
- Claude Code API 文档
- 移动端终端应用最佳实践

### 术语表
- **TUI**: Terminal User Interface，终端用户界面
- **SSH**: Secure Shell，安全外壳协议
- **WebSocket**: 全双工通信协议