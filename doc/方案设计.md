# 方案设计


## 前言 

初步的方案计划.


## 服务端 代理能力

当用户建立连接请求输入后.
进行鉴权,随后
1. 从数据库获取实际对应的 host,prot,username,password
2. 建立 ssh 连接
3. 获取 workdir 
4. 进入,并且执行 Claude code

获取 term 响应, 拿取具体信息.返回给 app

### 正常发送消息

当 app 发送命令 
如:

{
    "type":1 /字符串输入
    "msg":"你的执行不对,.我拒绝你的执行"
}
解析 msg, 塞入 ssh term 中


{
    "type":2 // 指令 
    "msg": "model"  //  切换 model
}




### 选项的交互

#### 识别

暂时没有好的办法,只有 正则匹配了

同时注意, ansi转义序列 不要忘了考虑

#### 发送
经过尝试,claude code 支持直接输入数字触发选项.所以对于选项,服务端只需要解析客户端的结果,然后发送数字就好


{
    "type":3 // 选择
    "msg": "1"  //   使用第一个 
}



### 中断执行

{
    "type":4 // 中断
}

服务端拿到后直接 输入 esc


